// Source code generated by AppGPT (www.appgpt.tech)

 //Class to create tables and seed new database
import { DataSource } from "typeorm";
import { DBConfiguration } from "./Configuration";
import { SettingsEntity } from "./db/Settings.entity";
//autogenerate imports based on resources
import { UsersEntity } from "./db/Users.entity";
import { EmployeesEntity } from "./db/Employees.entity";
import { EvaluationsEntity } from "./db/Evaluations.entity";
import { PayrollEntity } from "./db/Payroll.entity";
import { LeaveRequestsEntity } from "./db/LeaveRequests.entity";

export class Database {
  static dbConfiguration: DBConfiguration;
  public static ds: DataSource;

  static async Initialize(dbConfiguration: DBConfiguration) {
    Database.dbConfiguration = dbConfiguration;
    let dbConfig: any = dbConfiguration as any;
    //Autogenerate entities array from resource names

    dbConfig.entities = [SettingsEntity, UsersEntity, EmployeesEntity, EvaluationsEntity, PayrollEntity, LeaveRequestsEntity];
    Database.ds = new DataSource(dbConfig);
    await Database.ds.initialize();

    //TODO: Drop all tables


    await Database.Seed();
  }
  static async Seed() {
    let data: any = {"Users":[{"userId":1,"name":"name 1","email":"email 1","password":"password 1","role":"role 1","id":93},{"userId":2,"name":"name 2","email":"email 2","password":"password 2","role":"role 2","id":98},{"userId":3,"name":"name 3","email":"email 3","password":"password 3","role":"role 3","id":99},{"userId":4,"name":"name 4","email":"email 4","password":"password 4","role":"role 4","id":9},{"userId":5,"name":"name 5","email":"email 5","password":"password 5","role":"role 5","id":36}],"Employees":[{"employeeId":1,"firstName":"firstName 1","lastName":"lastName 1","middleName":"middleName 1","dateOfBirth":"2024-04-01T04:53:02.070Z","gender":"gender 1","nationality":"nationality 1","maritalStatus":"maritalStatus 1","contactInformation":"contactInformation 1","address":"address 1","department":"department 1","position":"position 1","manager":"manager 1","employmentType":"employmentType 1","startDate":"2024-03-30T12:27:26.750Z","endDate":"2023-06-27T18:49:31.646Z","salaryInformation":0.56,"profilePicture":"profilePicture 1","id":21},{"employeeId":2,"firstName":"firstName 2","lastName":"lastName 2","middleName":"middleName 2","dateOfBirth":"2025-01-05T01:06:12.140Z","gender":"gender 2","nationality":"nationality 2","maritalStatus":"maritalStatus 2","contactInformation":"contactInformation 2","address":"address 2","department":"department 2","position":"position 2","manager":"manager 2","employmentType":"employmentType 2","startDate":"2024-03-20T00:51:18.164Z","endDate":"2024-05-17T20:19:04.171Z","salaryInformation":0.66,"profilePicture":"profilePicture 2","id":53},{"employeeId":3,"firstName":"firstName 3","lastName":"lastName 3","middleName":"middleName 3","dateOfBirth":"2023-08-10T20:47:54.517Z","gender":"gender 3","nationality":"nationality 3","maritalStatus":"maritalStatus 3","contactInformation":"contactInformation 3","address":"address 3","department":"department 3","position":"position 3","manager":"manager 3","employmentType":"employmentType 3","startDate":"2023-05-22T21:22:39.823Z","endDate":"2024-12-11T20:11:32.627Z","salaryInformation":0.76,"profilePicture":"profilePicture 3","id":90},{"employeeId":4,"firstName":"firstName 4","lastName":"lastName 4","middleName":"middleName 4","dateOfBirth":"2023-08-27T18:10:18.149Z","gender":"gender 4","nationality":"nationality 4","maritalStatus":"maritalStatus 4","contactInformation":"contactInformation 4","address":"address 4","department":"department 4","position":"position 4","manager":"manager 4","employmentType":"employmentType 4","startDate":"2023-07-20T02:02:37.486Z","endDate":"2024-03-23T15:59:54.455Z","salaryInformation":0.34,"profilePicture":"profilePicture 4","id":89},{"employeeId":5,"firstName":"firstName 5","lastName":"lastName 5","middleName":"middleName 5","dateOfBirth":"2024-02-17T19:45:01.739Z","gender":"gender 5","nationality":"nationality 5","maritalStatus":"maritalStatus 5","contactInformation":"contactInformation 5","address":"address 5","department":"department 5","position":"position 5","manager":"manager 5","employmentType":"employmentType 5","startDate":"2025-01-03T21:39:45.893Z","endDate":"2023-08-07T23:22:51.483Z","salaryInformation":0.88,"profilePicture":"profilePicture 5","id":72}],"Evaluations":[{"reviewId":1,"employeeId":1,"periodStart":"2025-02-09T13:29:35.993Z","periodEnd":"2024-09-01T06:02:20.537Z","goalsObjectives":"goalsObjectives 1","achievements":"achievements 1","improvementAreas":"improvementAreas 1","feedbackFromSupervisor":"feedbackFromSupervisor 1","overallRating":1,"recommendations":"recommendations 1","id":71},{"reviewId":2,"employeeId":2,"periodStart":"2023-12-27T13:22:42.695Z","periodEnd":"2023-04-04T15:14:23.449Z","goalsObjectives":"goalsObjectives 2","achievements":"achievements 2","improvementAreas":"improvementAreas 2","feedbackFromSupervisor":"feedbackFromSupervisor 2","overallRating":2,"recommendations":"recommendations 2","id":98},{"reviewId":3,"employeeId":3,"periodStart":"2024-05-01T11:34:44.478Z","periodEnd":"2024-05-25T02:10:08.238Z","goalsObjectives":"goalsObjectives 3","achievements":"achievements 3","improvementAreas":"improvementAreas 3","feedbackFromSupervisor":"feedbackFromSupervisor 3","overallRating":3,"recommendations":"recommendations 3","id":50},{"reviewId":4,"employeeId":4,"periodStart":"2025-03-28T15:32:56.331Z","periodEnd":"2024-03-19T03:02:27.479Z","goalsObjectives":"goalsObjectives 4","achievements":"achievements 4","improvementAreas":"improvementAreas 4","feedbackFromSupervisor":"feedbackFromSupervisor 4","overallRating":4,"recommendations":"recommendations 4","id":4},{"reviewId":5,"employeeId":5,"periodStart":"2023-12-27T07:49:52.156Z","periodEnd":"2024-06-09T22:26:53.178Z","goalsObjectives":"goalsObjectives 5","achievements":"achievements 5","improvementAreas":"improvementAreas 5","feedbackFromSupervisor":"feedbackFromSupervisor 5","overallRating":5,"recommendations":"recommendations 5","id":78}],"Payroll":[{"payrollId":1,"employeeId":1,"periodStartDate":"2024-04-16T01:09:48.891Z","periodEndDate":"2023-08-26T17:58:55.526Z","grossSalary":0.72,"deductions":0.67,"netSalary":0.79,"payDate":"2023-09-15T11:04:04.631Z","overtimeHours":1,"overtimePay":0.39,"id":46},{"payrollId":2,"employeeId":2,"periodStartDate":"2024-03-01T12:56:59.838Z","periodEndDate":"2024-07-15T08:45:35.665Z","grossSalary":0.77,"deductions":0.24,"netSalary":0.16,"payDate":"2024-04-30T20:42:29.219Z","overtimeHours":2,"overtimePay":0.46,"id":27},{"payrollId":3,"employeeId":3,"periodStartDate":"2024-10-10T22:14:45.565Z","periodEndDate":"2024-04-04T01:10:32.581Z","grossSalary":0.13,"deductions":0.71,"netSalary":0.3,"payDate":"2023-11-20T03:54:01.324Z","overtimeHours":3,"overtimePay":0.13,"id":86},{"payrollId":4,"employeeId":4,"periodStartDate":"2024-01-24T10:10:09.468Z","periodEndDate":"2025-03-06T12:44:10.968Z","grossSalary":0.44,"deductions":0.04,"netSalary":0.11,"payDate":"2024-06-14T16:43:01.455Z","overtimeHours":4,"overtimePay":0.04,"id":27},{"payrollId":5,"employeeId":5,"periodStartDate":"2023-09-01T04:39:05.342Z","periodEndDate":"2023-06-10T15:54:06.701Z","grossSalary":0.36,"deductions":0.9,"netSalary":0.93,"payDate":"2024-09-27T19:55:58.764Z","overtimeHours":5,"overtimePay":0.66,"id":65}],"LeaveRequests":[{"requestId":1,"employeeId":1,"typeOfLeave":"typeOfLeave 1","startDate":"2025-02-08T09:31:22.696Z","endDate":"2024-03-08T13:12:12.870Z","reason":"reason 1","approvalStatus":"approvalStatus 1","approverUserId":1,"id":73},{"requestId":2,"employeeId":2,"typeOfLeave":"typeOfLeave 2","startDate":"2023-08-13T18:56:48.962Z","endDate":"2023-08-12T23:20:53.310Z","reason":"reason 2","approvalStatus":"approvalStatus 2","approverUserId":2,"id":96},{"requestId":3,"employeeId":3,"typeOfLeave":"typeOfLeave 3","startDate":"2025-01-10T06:09:52.053Z","endDate":"2024-08-07T08:52:14.213Z","reason":"reason 3","approvalStatus":"approvalStatus 3","approverUserId":3,"id":66},{"requestId":4,"employeeId":4,"typeOfLeave":"typeOfLeave 4","startDate":"2024-03-10T20:32:02.430Z","endDate":"2024-01-10T03:08:05.108Z","reason":"reason 4","approvalStatus":"approvalStatus 4","approverUserId":4,"id":30},{"requestId":5,"employeeId":5,"typeOfLeave":"typeOfLeave 5","startDate":"2023-10-03T02:46:03.134Z","endDate":"2023-05-19T03:24:17.175Z","reason":"reason 5","approvalStatus":"approvalStatus 5","approverUserId":5,"id":17}]};
    //Autogenerate multiple such calls ie for each resource and its data object
    let isSeeded = await this.IsSeeded();
    //if (!isSeeded) {
    //forcing app recreation
    if (true){
      console.log('   Seeding database...');
      await this.SeedResource("UsersEntity", data.Users);
await this.SeedResource("EmployeesEntity", data.Employees);
await this.SeedResource("EvaluationsEntity", data.Evaluations);
await this.SeedResource("PayrollEntity", data.Payroll);
await this.SeedResource("LeaveRequestsEntity", data.LeaveRequests); 
      await this.SeedResource("SettingsEntity", {
        settingname: "isSeeded",
        settingvalue: "true",
      });
    }else{
      console.log('   Database seeded already!');
    }
  }
  static async IsSeeded() {
    const repo = Database.ds.getRepository("SettingsEntity");
    let rec: any = await repo.findOne({
      select: {
        settingname: true,
        settingvalue: true,
      },
      where: {
        settingname: "isSeeded",
      },
    });
    if (rec && rec.settingvalue) return true;
    return false;
  }
  static async SeedResource(resourceName: any, resourceData: any) {
    const repo = Database.ds.getRepository(resourceName);
    //await repo.clear();
    console.log('   Seeding table '+resourceName);
    await repo.upsert(resourceData, ["id"]);
  }
}

